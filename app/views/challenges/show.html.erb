
<div class="container-messenger" id="container-messenger" >
  <div class="container-messages previous-color" id="container-messages" >
  <div class="header-messenger">
      <span class="message-content-admin hide" id = "msgadmin">Le duel va commencer...</span>
  <h2 class = "hide" id="title"> Round 1 : présentez-vous à votre courtisée</h2>

    <span class="avatar-time hide" id="smalltime"> start! </span>

  </div>
<div class="body-container-messages">
  <div class = "countdown-text" id = "countdown-text">Le <span id = "encours"> duel </span> débute dans <span id = "bigtime">3</span> secondes. </div>
  <span class = "hide" id = "bigmsg"> Joutez! </span>
  <div class = "gif-space" id = "gifspace"></div>
  <div class="row">
    <div class="card-seduced" id = "card-seduced">
    <div id ="cardtime"> 10</div>
        <p> <span class = "generated_text"> Votre douce s'appelle </span><br/>
    <strong> <%=  @challenge.seduced.first_name %></p> </strong>
     <p> <span class = "generated_text"> Elle est</span> <br/>
    <strong> <%=  @challenge.seduced.i_am %> </p> </strong>
    <p> <span class = "generated_text"> Elle aime</span><br/>
    <strong> <%=  @challenge.seduced.i_like %> </p> </strong>
    <p> <span class = "generated_text"> Elle recherche</span><br/>
    <strong> <%=  @challenge.seduced.i_look_for %> </span></p> </strong>
  </div>

    <div id="messages">
      <%= render 'messages', challenge: @challenge %>
    </div>
  </div>
</div>

  <div class="container-input hide" id= "typebox">
    <div class="row">
      <div class="col-xs-12 col-md-offset-1 col-md-10">
        <%= simple_form_for [@challenge, @message], remote: true do |f| %>
          <%= f.error_notification %>
          <%= f.input :content, label: "" %>
        <% end %>
      </div>
    </div>
  </div>



</div>
</div>
<% content_for :after_js do %>
  <script>
  App.messages = App.cable.subscriptions.create('MessagesChannel', {
    received: function(data) {
      if (data.challenge_id === <%= @challenge.id %>) {
        // $("#messages").removeClass('hidden');

        // Fetch all messages
        $.getScript("<%= challenge_path(@challenge) %>");

        scroll_bottom();
        if (data.user_id == <%= current_user.id %>) {
          $('#message_content').val('');
        }
      }
    }
  });

  var scroll_bottom = function() {
    $('#messages').scrollTop($('#messages')[0].scrollHeight + 10);
  };

  </script>
<% end %>




